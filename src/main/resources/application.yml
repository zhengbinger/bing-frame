# 应用名称
spring:
  application:
    name: bing-framework
  profiles:
    active: dev  # 默认使用开发环境
  
  # 国际化配置
  messages:
    basename: i18n/messages
    encoding: UTF-8
    fallback-to-system-locale: false
    default-locale: zh_CN
    cache-duration: 60s
  
  # MVC配置
  mvc:
    pathmatch:
      matching-strategy: ant_path_matcher
    cors:
      allowed-origins: '*'
      allowed-methods: GET,POST,PUT,DELETE,OPTIONS
      allowed-headers: '*'
      max-age: 3600
  
  # 数据库连接池配置
  datasource:
    url: jdbc:mysql://localhost:3306/bing_framework?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai
    username: root
    password: root
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      pool-name: BingFrameworkHikariCP
  
  # JPA配置已禁用，项目使用MyBatis作为主要ORM框架
  # jpa:
  #   hibernate:
  #     ddl-auto: update
  #   show-sql: false
  #   open-in-view: false
  #   properties:
  #     hibernate:
  #       dialect: org.hibernate.dialect.MySQL8Dialect
  #       format_sql: false
  #       use_sql_comments: false
  #       jdbc.batch_size: 30
  #       order_inserts: true
  #       order_updates: true
  #       cache.use_second_level_cache: false
  #       cache.use_query_cache: false
  #   database-platform: org.hibernate.dialect.MySQL8Dialect
  #   generate-ddl: true
  
  # 缓存配置 - 建议生产环境使用Redis
  cache:
    type: simple
    cache-names: auditLogCache,userCache
  
  # 异步任务配置
  task:
    execution:
      pool:
        core-size: 10
        max-size: 50
        queue-capacity: 1000
        keep-alive: 60s
        thread-name-prefix: audit-log-executor-
      # 启用任务执行的优雅关闭
      shutdown:
        await-termination: true
        await-termination-period: 60s
  
  # 额外的Spring配置
  main:
    allow-bean-definition-overriding: true
    # 启用全局懒加载，提升启动性能
    lazy-initialization: true
    # 指定Web应用类型
    web-application-type: servlet
    # 启用Bean的并行初始化
    # 在Spring Boot 2.4+中使用application-startup配置
    # 暂时注释，避免版本兼容性问题
    # application-startup: default

# 服务器配置
server:
  port: 8081
  servlet:
    context-path: /api
    session:
      timeout: 30m
  tomcat:
    uri-encoding: UTF-8
    max-connections: 10000
    threads:
      max: 200
      min-spare: 10
    connection-timeout: 20000

# MyBatis配置
mybatis:
  mapper-locations: classpath:mapper/*.xml
  configuration:
    map-underscore-to-camel-case: true
    default-fetch-size: 100
    default-statement-timeout: 30
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      id-type: AUTO
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# 日志配置 - 更详细的日志设置
logging:
  level:
    root: INFO
    com.bing.framework: INFO
    org.springframework: WARN
    org.hibernate: WARN
    org.apache.ibatis: WARN
    org.apache.tomcat: WARN
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n'
  file:
    name: logs/bing-framework.log
    max-size: 10MB
    max-history: 7

# Knife4j配置 - 增强API文档功能
knife4j:
  enable: true
  setting:
    language: zh_cn
    swagger-model-name: 实体类
  openapi:
    title: Bing Framework API
    description: Bing Framework RESTful API文档
    version: 1.0.0
    group:
      default:
        group-name: 默认接口
        api-rule:
          include-path-patterns:
            - /api/**
  cors: true
  # 文档访问路径: http://localhost:8081/api/doc.html

# 自定义配置
app:
  # 应用相关配置
  name: ${spring.application.name}
  version: 1.0.0
  # 安全配置
  security:
    token:
      expire-time: 7200
      secret: your-secret-key-here
  # 审计日志配置
  audit:
    enabled: true
    async-enabled: true