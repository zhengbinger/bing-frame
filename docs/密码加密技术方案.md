# é…ç½®æ–‡ä»¶å¯†ç åŠ å¯†æŠ€æœ¯æ–¹æ¡ˆ

## æ–¹æ¡ˆæ¦‚è¿°

æœ¬æ–¹æ¡ˆæä¾›ä¸€å¥—å®Œæ•´çš„é…ç½®æ–‡ä»¶å¯†ç åŠ å¯†æŠ€æœ¯ï¼Œå®ç°æ•æ„Ÿä¿¡æ¯çš„åŠ å¯†å­˜å‚¨å’Œè§£å¯†ä½¿ç”¨ï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒä¸­æ•æ„Ÿä¿¡æ¯çš„å®‰å…¨æ€§ã€‚

## æŠ€æœ¯æ–¹æ¡ˆ

### 1. æŠ€æœ¯é€‰å‹

#### 1.1 åŠ å¯†ç®—æ³•é€‰æ‹©
- **å¯¹ç§°åŠ å¯†**: AES-256-GCM (æ¨è)
  - å¯†é’¥é•¿åº¦: 256ä½
  - æ¨¡å¼: GCM (Galois/Counter Mode)
  - ä¼˜åŠ¿: å®‰å…¨æ€§é«˜ã€æ€§èƒ½å¥½ã€è®¤è¯åŠ å¯†ä¸€ä½“åŒ–

- **éå¯¹ç§°åŠ å¯†**: RSA-2048 (ç”¨äºå¯†é’¥äº¤æ¢)
  - ç”¨äºåŠ å¯†å¯¹ç§°å¯†é’¥
  - æ”¯æŒæ•°å­—ç­¾åéªŒè¯

#### 1.2 å¯†é’¥ç®¡ç†
- **å¯†é’¥æ´¾ç”Ÿ**: PBKDF2 (Password-Based Key Derivation Function 2)
  - è¿­ä»£æ¬¡æ•°: 100,000æ¬¡
  - ç›å€¼é•¿åº¦: 32å­—èŠ‚
  - è¾“å‡ºé•¿åº¦: 256ä½

- **å¯†é’¥å­˜å‚¨**
  - å¼€å‘ç¯å¢ƒ: ç¯å¢ƒå˜é‡æˆ–æœ¬åœ°å¯†é’¥æ–‡ä»¶
  - ç”Ÿäº§ç¯å¢ƒ: ä¸“ä¸šå¯†é’¥ç®¡ç†ç³»ç»Ÿ (KMS/HSM)

### 2. å®ç°æ¶æ„

```
é…ç½®æ–‡ä»¶ â†’ åŠ å¯†å­˜å‚¨ â†’ è¿è¡Œæ—¶è§£å¯† â†’ åº”ç”¨ä½¿ç”¨
    â†“           â†“          â†“         â†“
æ˜æ–‡é…ç½® â†’ AESåŠ å¯† â†’ å¯†æ–‡é…ç½® â†’ å†…å­˜è§£å¯† â†’ ä¸šåŠ¡é€»è¾‘
```

### 3. æ ¸å¿ƒç»„ä»¶

#### 3.1 åŠ å¯†å·¥å…·ç±» (EncryptUtil)
- å­—ç¬¦ä¸²åŠ å¯†/è§£å¯†
- æ–‡ä»¶åŠ å¯†/è§£å¯†
- å¯†é’¥æ´¾ç”Ÿå’Œç®¡ç†

#### 3.2 é…ç½®å¤„ç†å™¨ (EncryptedPropertyProcessor)
- Spring Booté…ç½®å±æ€§å¤„ç†å™¨
- è‡ªåŠ¨è§£å¯†é…ç½®å€¼
- æ”¯æŒåµŒå¥—é…ç½®è§£å¯†

#### 3.3 å¯†é’¥ç®¡ç†å™¨ (KeyManager)
- å¯†é’¥ç”Ÿæˆå’Œå­˜å‚¨
- å¯†é’¥è½®æ¢æ”¯æŒ
- å¤šç¯å¢ƒå¯†é’¥ç®¡ç†

## å®ç°åŸç†

### åŠ å¯†æµç¨‹å¯è§†åŒ–å›¾è§£

ğŸ“Š **å®Œæ•´æµç¨‹å›¾è¯·ç‚¹å‡»æŸ¥çœ‹**: [å¯†ç åŠ å¯†æµç¨‹å›¾.html](./å¯†ç åŠ å¯†æµç¨‹å›¾.html)

![åŠ å¯†æµç¨‹æ€»è§ˆ](password_encryption_flow_diagram.png)

**ğŸ”— åœ¨çº¿æŸ¥çœ‹å®Œæ•´æµç¨‹å›¾**: 
- ğŸ“ æ–‡ä»¶è·¯å¾„: `docs/å¯†ç åŠ å¯†æµç¨‹å›¾.html`
- ğŸŒ åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å³å¯æŸ¥çœ‹äº¤äº’å¼æµç¨‹å›¾

> **æç¤º**: HTMLç‰ˆæœ¬åŒ…å«å½©è‰²æµç¨‹å›¾ã€äº¤äº’å¼è®¾è®¡å’Œè¯¦ç»†çš„æŠ€æœ¯è¯´æ˜ï¼Œæ¯”çº¯ASCIIå›¾æ›´ç›´è§‚æ˜“æ‡‚ï¼

> **ğŸš€ æ–°ç‰ˆæœ¬åŒ…å«ä»¥ä¸‹æ”¹è¿›**:
> - ğŸ¨ **å½©è‰²æµç¨‹å›¾**: ä½¿ç”¨é¢œè‰²ç¼–ç åŒºåˆ†ä¸åŒé˜¶æ®µçš„å¤„ç†è¿‡ç¨‹
> - ğŸ–±ï¸ **äº¤äº’å¼è®¾è®¡**: æ”¯æŒç‚¹å‡»å±•å¼€è¯¦ç»†ä¿¡æ¯å’ŒåŠ¨ç”»æ¼”ç¤º
> - ğŸ“± **å“åº”å¼å¸ƒå±€**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œéšæ—¶éšåœ°æŸ¥çœ‹
> - ğŸ”§ **æŠ€æœ¯ç»†èŠ‚**: åŒ…å«å‚æ•°é…ç½®ã€æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µæŒ‡å—

### Spring Booté…ç½®è§£ææµç¨‹

ğŸ”— **è¯¦ç»†æµç¨‹å›¾è¯·ç‚¹å‡»æŸ¥çœ‹**: [å¯†ç åŠ å¯†æµç¨‹å›¾.html](./å¯†ç åŠ å¯†æµç¨‹å›¾.html#spring-booté…ç½®è§£ææµç¨‹)

### é…ç½®æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†

ğŸ”— **è¯¦ç»†æµç¨‹å›¾è¯·ç‚¹å‡»æŸ¥çœ‹**: [å¯†ç åŠ å¯†æµç¨‹å›¾.html](./å¯†ç åŠ å¯†æµç¨‹å›¾.html#é…ç½®æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†)

## æŠ€æœ¯å®ç°

### 1. Mavenä¾èµ–é…ç½®

```xml
<dependencies>
    <!-- Spring Boot Configuration Processor -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-configuration-processor</artifactId>
        <optional>true</option>
    </dependency>
    
    <!-- JCEåŠ å¯†åº“ -->
    <dependency>
        <groupId>org.bouncycastle</groupId>
        <artifactId>bcprov-jdk15on</artifactId>
        <version>1.70</version>
    </dependency>
    
    <!-- å¯†é’¥åº“ -->
    <dependency>
        <groupId>com.typesafe</groupId>
        <artifactId>config</artifactId>
        <version>1.4.3</version>
    </dependency>
</dependencies>
```

### 2. åŠ å¯†å·¥å…·ç±»å®ç°

```java
package com.bing.framework.security;

import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.springframework.stereotype.Component;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.GCMParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import java.security.Security;
import java.security.SecureRandom;
import java.util.Base64;

/**
 * åŠ å¯†å·¥å…·ç±»
 * æ”¯æŒAES-256-GCMåŠ å¯†è§£å¯†
 * 
 * @author zhengbing
 * @date 2025-11-20
 */
@Component
public class EncryptUtil {
    
    static {
        // æ³¨å†ŒBouncyCastleå®‰å…¨æä¾›ç¨‹åº
        Security.addProvider(new BouncyCastleProvider());
    }
    
    private static final String ALGORITHM = "AES";
    private static final String TRANSFORMATION = "AES/GCM/NoPadding";
    private static final int KEY_LENGTH = 256;
    private static final int IV_LENGTH = 12; // GCMæ¨¡å¼æ¨è12å­—èŠ‚IV
    private static final int TAG_LENGTH = 128; // è®¤è¯æ ‡ç­¾é•¿åº¦
    private static final int PBKDF2_ITERATIONS = 100000;
    private static final int PBKDF2_KEY_LENGTH = 256;
    
    /**
     * ç”Ÿæˆéšæœºå¯†é’¥
     */
    public static String generateKey() throws Exception {
        KeyGenerator keyGenerator = KeyGenerator.getInstance(ALGORITHM);
        keyGenerator.init(KEY_LENGTH);
        SecretKey secretKey = keyGenerator.generateKey();
        return Base64.getEncoder().encodeToString(secretKey.getEncoded());
    }
    
    /**
     * ä½¿ç”¨å¯†ç æ´¾ç”Ÿå¯†é’¥
     */
    public static SecretKey deriveKey(String password, byte[] salt) throws Exception {
        javax.crypto.SecretKeyFactory factory = 
            javax.crypto.SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
        javax.crypto.spec.PBEKeySpec spec = new javax.crypto.spec.PBEKeySpec(
            password.toCharArray(), 
            salt, 
            PBKDF2_ITERATIONS, 
            PBKDF2_KEY_LENGTH
        );
        SecretKey tmp = factory.generateSecret(spec);
        return new SecretKeySpec(tmp.getEncoded(), ALGORITHM);
    }
    
    /**
     * AES-GCMåŠ å¯†
     */
    public static String encrypt(String plainText, String base64Key) throws Exception {
        byte[] keyBytes = Base64.getDecoder().decode(base64Key);
        SecretKey secretKey = new SecretKeySpec(keyBytes, ALGORITHM);
        
        // ç”ŸæˆéšæœºIV
        byte[] iv = new byte[IV_LENGTH];
        SecureRandom random = new SecureRandom();
        random.nextBytes(iv);
        
        Cipher cipher = Cipher.getInstance(TRANSFORMATION);
        GCMParameterSpec gcmSpec = new GCMParameterSpec(TAG_LENGTH, iv);
        cipher.init(Cipher.ENCRYPT_MODE, secretKey, gcmSpec);
        
        byte[] encryptedData = cipher.doFinal(plainText.getBytes("UTF-8"));
        
        // æ‹¼æ¥IVå’ŒåŠ å¯†æ•°æ®
        byte[] combined = new byte[iv.length + encryptedData.length];
        System.arraycopy(iv, 0, combined, 0, iv.length);
        System.arraycopy(encryptedData, 0, combined, iv.length, encryptedData.length);
        
        return Base64.getEncoder().encodeToString(combined);
    }
    
    /**
     * AES-GCMè§£å¯†
     */
    public static String decrypt(String encryptedText, String base64Key) throws Exception {
        byte[] keyBytes = Base64.getDecoder().decode(base64Key);
        SecretKey secretKey = new SecretKeySpec(keyBytes, ALGORITHM);
        
        byte[] combined = Base64.getDecoder().decode(encryptedText);
        
        // æå–IVå’ŒåŠ å¯†æ•°æ®
        byte[] iv = new byte[IV_LENGTH];
        byte[] encryptedData = new byte[combined.length - IV_LENGTH];
        System.arraycopy(combined, 0, iv, 0, IV_LENGTH);
        System.arraycopy(combined, IV_LENGTH, encryptedData, 0, encryptedData.length);
        
        Cipher cipher = Cipher.getInstance(TRANSFORMATION);
        GCMParameterSpec gcmSpec = new GCMParameterSpec(TAG_LENGTH, iv);
        cipher.init(Cipher.DECRYPT_MODE, secretKey, gcmSpec);
        
        byte[] decryptedData = cipher.doFinal(encryptedData);
        return new String(decryptedData, "UTF-8");
    }
    
    /**
     * ä½¿ç”¨å¯†ç åŠ å¯†
     */
    public static String encryptWithPassword(String plainText, String password) throws Exception {
        byte[] salt = new byte[32];
        SecureRandom random = new SecureRandom();
        random.nextBytes(salt);
        
        SecretKey secretKey = deriveKey(password, salt);
        String key = Base64.getEncoder().encodeToString(secretKey.getEncoded());
        
        String encrypted = encrypt(plainText, key);
        
        // å°†ç›å€¼é™„åŠ åˆ°åŠ å¯†ç»“æœä¸­
        byte[] saltAndCipher = new byte[salt.length + encrypted.getBytes().length];
        System.arraycopy(salt, 0, saltAndCipher, 0, salt.length);
        System.arraycopy(encrypted.getBytes(), 0, saltAndCipher, salt.length, encrypted.getBytes().length);
        
        return Base64.getEncoder().encodeToString(saltAndCipher);
    }
    
    /**
     * ä½¿ç”¨å¯†ç è§£å¯†
     */
    public static String decryptWithPassword(String encryptedText, String password) throws Exception {
        byte[] saltAndCipher = Base64.getDecoder().decode(encryptedText);
        
        byte[] salt = new byte[32];
        byte[] cipherBytes = new byte[saltAndCipher.length - salt.length];
        System.arraycopy(saltAndCipher, 0, salt, 0, salt.length);
        System.arraycopy(saltAndCipher, salt.length, cipherBytes, 0, cipherBytes.length);
        
        SecretKey secretKey = deriveKey(password, salt);
        String key = Base64.getEncoder().encodeToString(secretKey.getEncoded());
        
        return decrypt(new String(cipherBytes), key);
    }
}
```

### 3. é…ç½®å±æ€§å¤„ç†å™¨

```java
package com.bing.framework.security;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

/**
 * åŠ å¯†é…ç½®å±æ€§å¤„ç†å™¨
 * è‡ªåŠ¨è§£å¯†ä»¥ENC(å¼€å¤´çš„é…ç½®å€¼
 * 
 * @author zhengbing
 * @date 2025-11-20
 */
@Component
public class EncryptedPropertyProcessor {
    
    private final Map<String, String> decryptedCache = new ConcurrentHashMap<>();
    private final EncryptUtil encryptUtil;
    
    @Value("${app.encryption.key:}")
    private String encryptionKey;
    
    public EncryptedPropertyProcessor(EncryptUtil encryptUtil) {
        this.encryptUtil = encryptUtil;
    }
    
    /**
     * è§£å¯†é…ç½®å€¼
     */
    public String decryptProperty(String propertyValue) {
        if (propertyValue == null || !propertyValue.startsWith("ENC(") || !propertyValue.endsWith(")")) {
            return propertyValue;
        }
        
        String encryptedValue = propertyValue.substring(4, propertyValue.length() - 1);
        
        // æ£€æŸ¥ç¼“å­˜
        String cacheKey = encryptionKey + ":" + encryptedValue;
        return decryptedCache.computeIfAbsent(cacheKey, k -> {
            try {
                return encryptUtil.decrypt(encryptedValue, encryptionKey);
            } catch (Exception e) {
                throw new RuntimeException("Failed to decrypt property: " + propertyValue, e);
            }
        });
    }
    
    /**
     * åŠ å¯†é…ç½®å€¼
     */
    public String encryptProperty(String plainValue) {
        try {
            return "ENC(" + encryptUtil.encrypt(plainValue, encryptionKey) + ")";
        } catch (Exception e) {
            throw new RuntimeException("Failed to encrypt property: " + plainValue, e);
        }
    }
    
    /**
     * æ¸…ç†è§£å¯†ç¼“å­˜
     */
    public void clearCache() {
        decryptedCache.clear();
    }
}
```

### 4. é…ç½®å±æ€§æº

```java
package com.bing.framework.security;

import org.springframework.core.env.MapPropertySource;

import java.util.HashMap;
import java.util.Map;

/**
 * åŠ å¯†å±æ€§æº
 * è‡ªåŠ¨è§£å¯†é…ç½®å€¼
 * 
 * @author zhengbing
 * @date 2025-11-20
 */
public class EncryptedPropertySource extends MapPropertySource {
    
    private final EncryptedPropertyProcessor processor;
    
    public EncryptedPropertySource(String name, 
                                 Map<String, Object> source, 
                                 EncryptedPropertyProcessor processor) {
        super(name, source);
        this.processor = processor;
    }
    
    @Override
    public Object getProperty(String name) {
        Object value = super.getProperty(name);
        if (value instanceof String) {
            return processor.decryptProperty((String) value);
        }
        return value;
    }
    
    @Override
    public Map<String, Object> getSource() {
        Map<String, Object> decryptedSource = new HashMap<>();
        for (Map.Entry<String, Object> entry : super.getSource().entrySet()) {
            Object value = entry.getValue();
            if (value instanceof String) {
                decryptedSource.put(entry.getKey(), processor.decryptProperty((String) value));
            } else {
                decryptedSource.put(entry.getKey(), value);
            }
        }
        return decryptedSource;
    }
}
```

### 5. Spring Booté…ç½®ç±»

```java
package com.bing.framework.config;

import com.bing.framework.security.EncryptedPropertyProcessor;
import com.bing.framework.security.EncryptedPropertySource;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.MapPropertySource;

import java.util.HashMap;
import java.util.Map;

/**
 * åŠ å¯†é…ç½®å±æ€§é…ç½®
 * 
 * @author zhengbing
 * @date 2025-11-20
 */
@Configuration
public class EncryptedPropertyConfig {
    
    /**
     * åŠ å¯†é…ç½®å±æ€§å¤„ç†å™¨
     */
    @Bean
    public EncryptedPropertyProcessor encryptedPropertyProcessor() {
        return new EncryptedPropertyProcessor();
    }
    
    /**
     * åŠ å¯†å±æ€§é…ç½®
     */
    @Bean
    @ConfigurationProperties(prefix = "app.encrypted")
    public EncryptedProperties encryptedProperties() {
        return new EncryptedProperties();
    }
    
    /**
     * åŠ å¯†å±æ€§
     */
    public static class EncryptedProperties {
        private String databasePassword;
        private String redisPassword;
        private String jwtSecret;
        private String apiKey;
        
        // Getters and Setters
        public String getDatabasePassword() { return databasePassword; }
        public void setDatabasePassword(String databasePassword) { 
            this.databasePassword = databasePassword; 
        }
        
        public String getRedisPassword() { return redisPassword; }
        public void setRedisPassword(String redisPassword) { 
            this.redisPassword = redisPassword; 
        }
        
        public String getJwtSecret() { return jwtSecret; }
        public void setJwtSecret(String jwtSecret) { 
            this.jwtSecret = jwtSecret; 
        }
        
        public String getApiKey() { return apiKey; }
        public void setApiKey(String apiKey) { 
            this.apiKey = apiKey; 
        }
    }
}
```

## ä½¿ç”¨ç¤ºä¾‹

### 1. application.ymlé…ç½®

```yaml
# åŠ å¯†é…ç½®
app:
  encryption:
    key: ${ENCRYPTION_KEY:your-base64-encryption-key-here}
  
  # åŠ å¯†åçš„æ•æ„Ÿä¿¡æ¯
  encrypted:
    database-password: ENC(AESåŠ å¯†åçš„æ•°æ®åº“å¯†ç )
    redis-password: ENC(AESåŠ å¯†åçš„Rediså¯†ç )
    jwt-secret: ENC(AESåŠ å¯†åçš„JWTå¯†é’¥)
    api-key: ENC(AESåŠ å¯†åçš„APIå¯†é’¥)

# æœªåŠ å¯†çš„é…ç½®
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/bing_framework
    username: ${DB_USERNAME:root}
    password: ${app.encrypted.database-password}
  
  redis:
    host: localhost
    port: 6379
    password: ${app.encrypted.redis-password}

# JWTé…ç½®
jwt:
  secret: ${app.encrypted.jwt-secret}
  expiration: 86400
```

### 2. é…ç½®åŠ å¯†å·¥å…·

```java
package com.bing.framework.security;

import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

/**
 * é…ç½®åŠ å¯†å·¥å…·
 * ç”¨äºç”Ÿæˆå’ŒåŠ å¯†é…ç½®
 * 
 * @author zhengbing
 * @date 2025-11-20
 */
@Component
public class ConfigEncryptionTool implements CommandLineRunner {
    
    private final EncryptUtil encryptUtil;
    
    public ConfigEncryptionTool(EncryptUtil encryptUtil) {
        this.encryptUtil = encryptUtil;
    }
    
    @Override
    public void run(String... args) throws Exception {
        if (args.length > 0 && "encrypt".equals(args[0])) {
            if (args.length < 3) {
                System.out.println("Usage: java -jar app.jar encrypt <key> <plaintext>");
                System.exit(1);
            }
            
            String key = args[1];
            String plainText = args[2];
            
            String encrypted = encryptUtil.encrypt(plainText, key);
            System.out.println("Encrypted: ENC(" + encrypted + ")");
            
            String decrypted = encryptUtil.decrypt(encrypted, key);
            System.out.println("Decrypted: " + decrypted);
        }
    }
}
```

## å¯†é’¥ç®¡ç†ç­–ç•¥

### 1. å¼€å‘ç¯å¢ƒ
```bash
# ç¯å¢ƒå˜é‡æ–¹å¼
export ENCRYPTION_KEY=$(openssl rand -base64 32)

# æœ¬åœ°å¯†é’¥æ–‡ä»¶
echo "your-encryption-key-here" > ~/.encryption-key
```

### 2. æµ‹è¯•ç¯å¢ƒ
```yaml
# application-test.yml
app:
  encryption:
    key-file: /etc/keys/encryption.key
```

### 3. ç”Ÿäº§ç¯å¢ƒ
- **é€‰é¡¹1**: Kubernetes Secrets
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: encryption-key
type: Opaque
data:
  key: <base64-encoded-encryption-key>
```

- **é€‰é¡¹2**: AWS KMS/Azure Key Vault
```java
@Value("${cloud.aws.kms.key-id}")
private String kmsKeyId;

// ä½¿ç”¨KMSåŠ å¯†/è§£å¯†
String encrypted = kmsClient.encrypt(plainText);
String decrypted = kmsClient.decrypt(encrypted);
```

## å®‰å…¨æ€§åˆ†æ

### 1. ä¼˜åŠ¿
- **å¼ºåŠ å¯†**: AES-256-GCMæä¾›å†›äº‹çº§å®‰å…¨æ€§
- **è®¤è¯åŠ å¯†**: GCMæ¨¡å¼æä¾›è®¤è¯åŠŸèƒ½ï¼Œé˜²æ­¢ç¯¡æ”¹
- **å¯†é’¥æ´¾ç”Ÿ**: PBKDF2é˜²æ­¢æš´åŠ›ç ´è§£
- **è‡ªåŠ¨è§£å¯†**: å¯¹åº”ç”¨é€æ˜ï¼Œè‡ªåŠ¨å¤„ç†åŠ å¯†/è§£å¯†
- **çµæ´»é…ç½®**: æ”¯æŒå¤šç§å¯†é’¥ç®¡ç†æ–¹å¼

### 2. é£é™©å’Œç¼“è§£
- **å¯†é’¥æ³„éœ²**: ä½¿ç”¨ä¸“ä¸šKMSç³»ç»Ÿï¼Œå®šæœŸè½®æ¢å¯†é’¥
- **å†…å­˜æ³„éœ²**: è§£å¯†åç«‹å³ä½¿ç”¨ï¼ŒåŠæ—¶æ¸…ç†å†…å­˜
- **é…ç½®æ³„éœ²**: ç¡®ä¿é…ç½®æ–‡ä»¶è®¿é—®æƒé™ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡

### 3. æ€§èƒ½å½±å“
- **å¯åŠ¨æ—¶é—´**: é¦–æ¬¡è§£å¯†éœ€è¦æ—¶é—´ï¼Œåç»­ä½¿ç”¨ç¼“å­˜
- **å†…å­˜ä½¿ç”¨**: è§£å¯†åç¼“å­˜åœ¨å†…å­˜ä¸­
- **è®¡ç®—å¼€é”€**: AES-GCMåŠ è§£å¯†æ€§èƒ½ä¼˜ç§€

## éƒ¨ç½²æ­¥éª¤

### 1. ç”Ÿæˆå¯†é’¥
```bash
# ç”Ÿæˆéšæœºå¯†é’¥
KEY=$(java -cp app.jar com.bing.framework.security.EncryptUtil generateKey)
echo "Encryption Key: $KEY"

# åŠ å¯†æ•æ„Ÿä¿¡æ¯
ENCRYPTED_DB_PASSWORD=$(java -cp app.jar com.bing.framework.security.EncryptUtil encrypt "your-db-password" "$KEY")
echo "Encrypted DB Password: ENC($ENCRYPTED_DB_PASSWORD)"
```

### 2. é…ç½®åº”ç”¨
```yaml
app:
  encryption:
    key: ${ENCRYPTION_KEY}
  encrypted:
    database-password: ENC(${ENCRYPTED_DB_PASSWORD})
```

### 3. ç¯å¢ƒå˜é‡è®¾ç½®
```bash
export ENCRYPTION_KEY="your-base64-key"
export ENCRYPTED_DB_PASSWORD="ENC(encrypted-password)"
```

## ç›‘æ§å’Œå®¡è®¡

### 1. è§£å¯†æ“ä½œæ—¥å¿—
```java
// åœ¨EncryptedPropertyProcessorä¸­æ·»åŠ æ—¥å¿—
log.info("Decrypting property: {}", propertyName.substring(0, 10) + "...");
// è®°å½•è§£å¯†æ“ä½œï¼Œä½†ä¸è®°å½•æ˜æ–‡å†…å®¹
```

### 2. å¯†é’¥è®¿é—®å®¡è®¡
- è®°å½•å¯†é’¥è¯»å–æ“ä½œ
- ç›‘æ§å¼‚å¸¸è§£å¯†å¤±è´¥
- è®¾ç½®å¯†é’¥è®¿é—®æƒé™

## æ€»ç»“

æœ¬æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„é…ç½®æ–‡ä»¶å¯†ç åŠ å¯†æŠ€æœ¯å®ç°ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **å®‰å…¨å¯é **: é‡‡ç”¨AES-256-GCMå†›äº‹çº§åŠ å¯†ç®—æ³•
2. **æ˜“äºé›†æˆ**: ä¸Spring Bootæ— ç¼é›†æˆï¼Œå¯¹ä¸šåŠ¡ä»£ç é€æ˜
3. **çµæ´»é…ç½®**: æ”¯æŒå¤šç§å¯†é’¥ç®¡ç†æ–¹å¼
4. **æ€§èƒ½ä¼˜ç§€**: ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Œæœ€å°åŒ–æ€§èƒ½å½±å“
5. **ç”Ÿäº§å°±ç»ª**: æ”¯æŒå¤šç§éƒ¨ç½²ç¯å¢ƒå’Œå¯†é’¥ç®¡ç†ç­–ç•¥

å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œé…åˆä¸“ä¸šçš„å¯†é’¥ç®¡ç†ç³»ç»Ÿ(KMS)ä¸€èµ·ä½¿ç”¨ï¼Œä»¥è·å¾—æœ€ä½³çš„å®‰å…¨æ€§ä¿éšœã€‚