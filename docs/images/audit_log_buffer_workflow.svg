<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #e3f2fd; stroke: #1976d2; stroke-width: 2; }
      .process { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; }
      .arrow { stroke: #424242; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .text { font-family: Arial, sans-serif; font-size: 14px; fill: #424242; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #1976d2; text-anchor: middle; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#424242" />
    </marker>
  </defs>
  
  <!-- 标题 -->
  <text x="400" y="30" class="title">审计日志缓冲池工作流程</text>
  
  <!-- 业务操作 -->
  <rect x="50" y="80" width="120" height="60" class="box" rx="5"/>
  <text x="110" y="115" class="text">业务操作<br/>产生审计日志</text>
  
  <!-- 异步处理 -->
  <rect x="250" y="80" width="120" height="60" class="process" rx="5"/>
  <text x="310" y="115" class="text">异步处理<br/>(线程池)</text>
  
  <!-- 缓冲存储 -->
  <rect x="450" y="80" width="120" height="60" class="box" rx="5"/>
  <text x="510" y="115" class="text">缓冲队列<br/>(内存)</text>
  
  <!-- 批量写入 -->
  <rect x="650" y="80" width="120" height="60" class="process" rx="5"/>
  <text x="710" y="115" class="text">批量写入<br/>数据库</text>
  
  <!-- 定时刷新 -->
  <rect x="250" y="250" width="120" height="60" class="box" rx="5"/>
  <text x="310" y="285" class="text">定时任务<br/>刷新队列</text>
  
  <!-- 监控循环 -->
  <rect x="450" y="250" width="120" height="60" class="box" rx="5"/>
  <text x="510" y="285" class="text">监控阈值<br/>判断条件</text>
  
  <!-- 数据库 -->
  <rect x="650" y="250" width="120" height="60" class="process" rx="5"/>
  <text x="710" y="285" class="text">数据库<br/>持久化存储</text>
  
  <!-- 错误处理 -->
  <rect x="450" y="420" width="120" height="60" class="box" rx="5"/>
  <text x="510" y="455" class="text">异常处理<br/>重试机制</text>
  
  <!-- 箭头连接 -->
  <line x1="170" y1="110" x2="250" y2="110" class="arrow"/>
  <line x1="370" y1="110" x2="450" y2="110" class="arrow"/>
  <line x1="570" y1="110" x2="650" y2="110" class="arrow"/>
  <line x1="510" y1="140" x2="510" y2="250" class="arrow"/>
  <line x1="310" y1="140" x2="310" y2="250" class="arrow"/>
  <line x1="570" y1="280" x2="650" y2="280" class="arrow"/>
  <line x1="710" y1="310" x2="710" y2="180" class="arrow" stroke-dasharray="5,5"/>
  <line x1="510" y1="310" x2="510" y2="420" class="arrow"/>
  
  <!-- 说明文字 -->
  <text x="400" y="520" class="text">流程说明：业务操作→异步处理→缓冲存储→批量写入/定时刷新→数据库存储</text>
  <text x="400" y="540" class="text">监控机制：实时监控队列状态，当达到阈值或定时触发时进行批量处理</text>
  <text x="400" y="560" class="text">异常处理：数据库异常时采用重试机制，确保日志数据不丢失</text>
</svg>